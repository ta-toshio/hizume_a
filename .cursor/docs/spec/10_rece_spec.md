---
title: "レース仕様書（全体設計）"
free: false
---

## 🏁 レース仕様書（全体設計）

---

### ✅ 1. レース構成概要

| 項目   | 内容                             |
| ---- | ------------------------------ |
| 区間構成 | 3区間（序盤・中盤・終盤）                  |
| 処理単位 | 各区間ごとにスコア計算／スキル発動判定実施          |
| 評価方法 | 最終スコア = 区間スコア合計 + スキル加点 - 失速補正 |
| 勝敗決定 | 全馬のスコアを比較し順位を決定                |

---

### ✅ 2. スコア計算（各区間）

各区間ではステータスに応じたスコア計算を実施：

```ts
score = Σ(ステータス × 区間係数) + 発動スキル加点
```

#### 区間別ステータス比重（例）

| 区間 | 速力  | 展開  | 技術  | 精神  | 持久  |
| -- | --- | --- | --- | --- | --- |
| 序盤 | 40% | 30% | 10% | 10% | 10% |
| 中盤 | 25% | 30% | 20% | 15% | 10% |
| 終盤 | 30% | 15% | 10% | 20% | 25% |

---

### ✅ 3. スキル処理フロー

1. レース前：常時発動系スキル（ステ補正系）を適用
2. 各区間：

   * ステスコア算出
   * 発動条件に合致するスキルを自動発動（加点 or 補正）
   * 疲労・精神低下による失速補正を適用（-5〜-15）
3. 全区間終了後：最終スコアを合計
4. 着順決定：スコア降順で並び順位を決定

---

### ✅ 4. スキル加点・補正処理

| タイミング | 処理内容                     |
| ----- | ------------------------ |
| 開始前   | 初期集中力やステータス補正を一括適用       |
| 区間突入時 | 区間スキル（速度+10など）を加算／UI演出発火 |
| 状況発動  | 条件が満たされた時点で即時発動・補正反映     |

---

### ✅ 5. 特殊補正ロジック

* 疲労が80以上：各区間に -10〜-15 のペナルティ（ステと別）
* 精神が50未満：集中力欠如 → スキル発動確率-20%（発展要素）
* スキルが重複発動：同系統スキルは加点値の低い方を無効化

---

### ✅ 6. 結果出力項目

| 項目      | 内容                  |
| ------- | ------------------- |
| 着順      | 順位（1〜N）             |
| 最終スコア   | 区間＋スキル＋ペナルティ計       |
| 発動スキル一覧 | 名前・発動区間・効果          |
| ステータス内訳 | 各区間ごとの貢献ステ表示（棒グラフ可） |

---

このレース仕様により、育成成果（ステータス・スキル）が明確にレース結果へ反映され、納得感と戦略性ある勝敗判断が可能になります。